{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/jordisamardzic/Desktop/github/chatwoot-odoo-dashboard/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { fetchLeadByContactId } from '@/lib/api';\nimport { ChatwootContact } from '@/lib/types';\nimport LeadDetails from '@/components/LeadDetails';\nimport LeadPipeline from '@/components/LeadPipeline';\nimport ActionsPanel from '@/components/ActionsPanel';\nimport CreateLeadModal from '@/components/CreateLeadModal';\nimport AIAssistant from '@/components/AIAssistant';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';\nimport { Loader2, AlertCircle } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\n\nexport default function Dashboard() {\n  const [contact, setContact] = useState<ChatwootContact | null>(null);\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n\n  // Listen to Chatwoot events\n  useEffect(() => {\n    const handleMessage = (event: MessageEvent) => {\n      if (typeof event.data !== 'string') return;\n\n      try {\n        const parsed = JSON.parse(event.data);\n        if (parsed.event !== 'appContext') return;\n\n        const contactData = parsed.data.contact;\n        if (contactData) {\n          setContact({\n            id: contactData.id,\n            name: contactData.name,\n            email: contactData.email,\n            phone_number: contactData.phone_number,\n            custom_attributes: contactData.custom_attributes,\n          });\n        }\n      } catch (e) {\n        console.error(\"Error parsing Chatwoot event\", e);\n      }\n    };\n\n    window.addEventListener('message', handleMessage);\n    // Request context\n    window.parent.postMessage('chatwoot-dashboard-app:fetch-info', '*');\n\n    return () => window.removeEventListener('message', handleMessage);\n  }, []);\n\n  // Fetch Odoo Lead\n  const { data, isLoading, error, refetch } = useQuery({\n    queryKey: ['lead', contact?.id],\n    queryFn: () => fetchLeadByContactId(contact!.id),\n    enabled: !!contact?.id,\n  });\n\n  if (!contact) {\n    return (\n      <div className=\"flex h-screen items-center justify-center p-4\">\n        <Card className=\"w-full max-w-md\">\n          <CardContent className=\"flex flex-col items-center justify-center p-6 text-center\">\n            <Loader2 className=\"mb-4 h-8 w-8 animate-spin text-muted-foreground\" />\n            <p className=\"text-muted-foreground\">Wachten op Chatwoot data...</p>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <main className=\"container mx-auto max-w-3xl p-4 space-y-6 pb-20\">\n      <div className=\"flex items-center justify-between\">\n        <h1 className=\"text-xl font-bold\">Sales Command Center</h1>\n        <span className=\"text-xs text-muted-foreground\">Chatwoot ID: {contact.id}</span>\n      </div>\n\n      {isLoading && (\n        <div className=\"flex justify-center p-8\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-blue-600\" />\n        </div>\n      )}\n\n      {error && (\n        <Card className=\"border-red-200 bg-red-50\">\n          <CardContent className=\"flex items-center p-4 text-red-800\">\n            <AlertCircle className=\"mr-2 h-5 w-5\" />\n            Fout bij laden van Odoo data.\n          </CardContent>\n        </Card>\n      )}\n\n      {!isLoading && !error && !data?.lead && (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center p-8 space-y-4\">\n            <div className=\"text-lg font-semibold\">Geen Odoo lead gevonden</div>\n            <p className=\"text-center text-muted-foreground\">\n              Dit contact is nog niet gekoppeld aan een Odoo lead.\n            </p>\n            <Button onClick={() => setIsCreateModalOpen(true)}>\n              Maak of Koppel Lead\n            </Button>\n          </CardContent>\n        </Card>\n      )}\n\n      {!isLoading && data?.lead && (\n        <>\n          <Card>\n             <CardHeader className=\"pb-2\">\n                <div className=\"flex justify-between items-center\">\n                    <CardTitle>{data.lead.name}</CardTitle>\n                    <span className=\"text-xs text-muted-foreground\">ID: {data.lead.id}</span>\n                </div>\n             </CardHeader>\n             <CardContent>\n                <LeadPipeline lead={data.lead} />\n             </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-base\">Lead Details</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <LeadDetails lead={data.lead} />\n            </CardContent>\n          </Card>\n\n          <Card>\n             <CardContent className=\"pt-6\">\n                <ActionsPanel lead={data.lead} />\n             </CardContent>\n          </Card>\n        </>\n      )}\n\n      <CreateLeadModal \n        isOpen={isCreateModalOpen} \n        onClose={() => {\n            setIsCreateModalOpen(false);\n            refetch();\n        }}\n        contact={contact} \n      />\n\n      <AIAssistant />\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;AAOA;;;;;;AAEA;AAAA;;;;;;AAZA;;;;;;;;;;;;;AAee,SAAS;IACtB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,uQAAQ,EAAyB;IAC/D,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,uQAAQ,EAAC;IAE3D,4BAA4B;IAC5B,IAAA,wQAAS,EAAC;QACR,MAAM,gBAAgB,CAAC;YACrB,IAAI,OAAO,MAAM,IAAI,KAAK,UAAU;YAEpC,IAAI;gBACF,MAAM,SAAS,KAAK,KAAK,CAAC,MAAM,IAAI;gBACpC,IAAI,OAAO,KAAK,KAAK,cAAc;gBAEnC,MAAM,cAAc,OAAO,IAAI,CAAC,OAAO;gBACvC,IAAI,aAAa;oBACf,WAAW;wBACT,IAAI,YAAY,EAAE;wBAClB,MAAM,YAAY,IAAI;wBACtB,OAAO,YAAY,KAAK;wBACxB,cAAc,YAAY,YAAY;wBACtC,mBAAmB,YAAY,iBAAiB;oBAClD;gBACF;YACF,EAAE,OAAO,GAAG;gBACV,QAAQ,KAAK,CAAC,gCAAgC;YAChD;QACF;QAEA,OAAO,gBAAgB,CAAC,WAAW;QACnC,kBAAkB;QAClB,OAAO,MAAM,CAAC,WAAW,CAAC,qCAAqC;QAE/D,OAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;IACrD,GAAG,EAAE;IAEL,kBAAkB;IAClB,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,IAAA,6OAAQ,EAAC;QACnD,UAAU;YAAC;YAAQ,SAAS;SAAG;QAC/B,SAAS,IAAM,qBAAqB,QAAS,EAAE;QAC/C,SAAS,CAAC,CAAC,SAAS;IACtB;IAEA,IAAI,CAAC,SAAS;QACZ,qBACE,oSAAC;YAAI,WAAU;sBACb,cAAA,oSAAC;gBAAK,WAAU;0BACd,cAAA,oSAAC;oBAAY,WAAU;;sCACrB,oSAAC,kRAAO;4BAAC,WAAU;;;;;;sCACnB,oSAAC;4BAAE,WAAU;sCAAwB;;;;;;;;;;;;;;;;;;;;;;IAK/C;IAEA,qBACE,oSAAC;QAAK,WAAU;;0BACd,oSAAC;gBAAI,WAAU;;kCACb,oSAAC;wBAAG,WAAU;kCAAoB;;;;;;kCAClC,oSAAC;wBAAK,WAAU;;4BAAgC;4BAAc,QAAQ,EAAE;;;;;;;;;;;;;YAGzE,2BACC,oSAAC;gBAAI,WAAU;0BACb,cAAA,oSAAC,kRAAO;oBAAC,WAAU;;;;;;;;;;;YAItB,uBACC,oSAAC;gBAAK,WAAU;0BACd,cAAA,oSAAC;oBAAY,WAAU;;sCACrB,oSAAC,yRAAW;4BAAC,WAAU;;;;;;wBAAiB;;;;;;;;;;;;YAM7C,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,sBAC9B,oSAAC;0BACC,cAAA,oSAAC;oBAAY,WAAU;;sCACrB,oSAAC;4BAAI,WAAU;sCAAwB;;;;;;sCACvC,oSAAC;4BAAE,WAAU;sCAAoC;;;;;;sCAGjD,oSAAC;4BAAO,SAAS,IAAM,qBAAqB;sCAAO;;;;;;;;;;;;;;;;;YAOxD,CAAC,aAAa,MAAM,sBACnB;;kCACE,oSAAC;;0CACE,oSAAC;gCAAW,WAAU;0CACnB,cAAA,oSAAC;oCAAI,WAAU;;sDACX,oSAAC;sDAAW,KAAK,IAAI,CAAC,IAAI;;;;;;sDAC1B,oSAAC;4CAAK,WAAU;;gDAAgC;gDAAK,KAAK,IAAI,CAAC,EAAE;;;;;;;;;;;;;;;;;;0CAGxE,oSAAC;0CACE,cAAA,oSAAC;oCAAa,MAAM,KAAK,IAAI;;;;;;;;;;;;;;;;;kCAInC,oSAAC;;0CACC,oSAAC;0CACC,cAAA,oSAAC;oCAAU,WAAU;8CAAY;;;;;;;;;;;0CAEnC,oSAAC;0CACC,cAAA,oSAAC;oCAAY,MAAM,KAAK,IAAI;;;;;;;;;;;;;;;;;kCAIhC,oSAAC;kCACE,cAAA,oSAAC;4BAAY,WAAU;sCACpB,cAAA,oSAAC;gCAAa,MAAM,KAAK,IAAI;;;;;;;;;;;;;;;;;;0BAMvC,oSAAC;gBACC,QAAQ;gBACR,SAAS;oBACL,qBAAqB;oBACrB;gBACJ;gBACA,SAAS;;;;;;0BAGX,oSAAC,kMAAW;;;;;;;;;;;AAGlB"}}]
}